<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>c-lambda: C FFI via raco ctool</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="../racket.css" title="default" /><link rel="stylesheet" type="text/css" href="../scribble-style.css" title="default" /><script type="text/javascript" src="../scribble-common.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" pltdoc="x"><span class="RktSym"><span class="RktStxLink">c-<wbr></wbr>lambda</span></span>:<span class="mywbr"> </span> C FFI via <span class="stt">raco ctool</span></a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="#(part._doc-bibliography)" class="tocviewlink" pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: compiler/cffi"><span class="RktSym"><span class="RktStxLink">c-<wbr></wbr>lambda</span></span></span></a></td></tr><tr><td><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: compiler/cffi"><span class="RktSym"><span class="RktStxLink">c-<wbr></wbr>declare</span></span></span></a></td></tr><tr><td><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: compiler/cffi"><span class="RktSym"><span class="RktStxLink">c-<wbr></wbr>include</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#(part._doc-bibliography)" class="tocsubseclink" pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">Version: 5.0.2</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2><a name="(part._top)"></a><a name="(part._c-lambda__.C_.F.F.I_via_raco_ctool)"></a><a name="(mod-path._compiler/cffi)"></a><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span>: C FFI via <span class="stt">raco ctool</span></h2><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" pltdoc="x"><span class="RktSym">compiler/cffi</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">The <a href="" class="RktModLink" pltdoc="x"><span class="RktSym">compiler/cffi</span></a> module relies on a C compiler to
statically construct an interface to C code through directives
embedded in a Racket program. The library implements a subset of
<a name="(idx._(gentag._0._(lib._compiler/cffi..scrbl)))"></a>Gambit-C&rsquo;s foreign-function interface [<a href="#(cite._.Feeley98)" pltdoc="x">Feeley98</a>].</div></p><p>The <a href="../foreign/index.html" class="RktModLink" pltdoc="x"><span class="RktSym">ffi/unsafe</span></a> library is a better interface for
most tasks; see <a href="../foreign/index.html" pltdoc="x"><span style="font-weight: bold">FFI</span>: Racket Foreign Interface</a> for more information on
<a href="../foreign/index.html" class="RktModLink" pltdoc="x"><span class="RktSym">ffi/unsafe</span></a>. See also <a href="../inside/index.html" pltdoc="x"><span style="font-weight: bold">Inside</span>: Racket C API</a>, which describes
Racket&rsquo;s C-level API for extending the run-time system.</p><p>The <a href="" class="RktModLink" pltdoc="x"><span class="RktSym">compiler/cffi</span></a> library defines three forms:
<span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span>, <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span>, and <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span>. When
interpreted directly or compiled to byte code, <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span>
produces a function that always raises <span class="RktSym"><a href="../reference/exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span>, and
<span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> and <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span> raise
<span class="RktSym"><a href="../reference/exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span>. When compiled by <span class="stt">raco ctool --extension</span>, the forms
provide access to C. Thus, <a href="" class="RktModLink" pltdoc="x"><span class="RktSym">compiler/cffi</span></a> is normally
required by a module to be compiled via <span class="stt">raco ctool</span>. In addition, the
<span class="stt">raco ctool</span> compiler implicitly imports <a href="" class="RktModLink" pltdoc="x"><span class="RktSym">compiler/cffi</span></a> into
the top-level environment for non-<span class="RktSym"><a href="../reference/module.html#(form._((quote._~23~25kernel)._module))" class="RktStxLink" pltdoc="x">module</a></span> compilation.</p><p>The <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span> form creates a Racket procedure whose body is
implemented in C. Instead of declaring argument names, a
<span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span> form declares argument types, as well as a return
type. The implementation can be simply the name of a C function, as in
the following definition of <span class="RktSym">fmod</span>:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fmod</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">double</span><span class="hspace">&nbsp;</span><span class="RktSym">double</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">double</span><span class="hspace">&nbsp;</span><span class="RktVal">"fmod"</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>Alternatively, the implementation can be C code to serve as the body
of a function, where the arguments are bound to <span class="stt">___arg1</span> (three
underscores), etc., and the result is installed into <span class="stt">___result</span>
(three underscores):</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">machine-string-&gt;float</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">char-string</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">float</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"___result = *(float *)___arg1;"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>The <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span> form provides only limited conversions between C
and Racket data. For example, the following function does not reliably
produce a string of four characters:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">broken-machine-float-&gt;string</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">float</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">char-string</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"char b[5]; *(float *)b = ___arg1; b[4] = 0; ___result = b;"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>because the representation of a <span class="stt">float</span> can contain null bytes,
which terminate the string. However, the full Racket API, which is
described in <a href="../inside/index.html" pltdoc="x"><span style="font-weight: bold">Inside</span>: Racket C API</a>, can be used in a function body:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">machine-float-&gt;string</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">float</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">racket-object</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"char b[4];"</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"*(float *)b = ___arg1;"</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"___result = racket_make_sized_byte_string(b, 4, 1);"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>The <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> form declares arbitrary C code to appear after
<span class="stt">"escheme.h"</span> or <span class="stt">"scheme.h"</span> is included, but before
any other code in the compilation environment of the declaration. It
is often used to declare C header file inclusions. For example, a
proper definition of <span class="RktSym">fmod</span> needs the <span class="stt">"math.h"</span> header
file:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"#include &lt;math.h&gt;"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fmod</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">double</span><span class="hspace">&nbsp;</span><span class="RktSym">double</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">double</span><span class="hspace">&nbsp;</span><span class="RktVal">"fmod"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>The <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> form can also be used to define helper C
functions to be called through <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span>.</p><p>The <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span> form expands to a <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> form using
the content of a specified file. Use <span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span><span class="stt"> </span><span class="RktVar">file</span><span class="RktPn">)</span> instead
of <span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span><span class="stt"> </span><span class="RktVal">"#include file"</span><span class="RktPn">)</span> when it&rsquo;s easier to
have Racket resolve the file path than to have the C compiler
resolve it.</p><p>The <span class="stt">"collects/mzscheme/examples"</span> directory in the Racket
distribution contains additional examples.</p><p>When compiling for Racket 3m (see <a href="../inside/index.html" pltdoc="x"><span style="font-weight: bold">Inside</span>: Racket C API</a>), C code inserted by
<span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span>, <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span>, and <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span> will be
transformed in the same was as <span class="stt">raco ctool</span>&rsquo;s <span class="nobreak"><span class="stt">--xform</span></span> mode (which may
or may not be enough to make the code work correctly in Racket 3m;
see <a href="../inside/index.html" pltdoc="x"><span style="font-weight: bold">Inside</span>: Racket C API</a> for more information).</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._compiler/cffi..rkt)._c-lambda))"></a><a name="(form._((lib._compiler/cffi..rkt)._c-lambda))"></a><span title="Provided from: compiler/cffi"><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-lambda))" class="RktStxLink" pltdoc="x">c-lambda</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">argument-type</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">return-type</span><span class="hspace">&nbsp;</span><span class="RktVar">impl-string</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Creates a Racket procedure whose body is implemented in C. The
procedure takes as many arguments as the supplied
<span class="RktVar">argument-type</span>s, and it returns one value. If
<span class="RktVar">return-type</span> is <span class="RktSym">void</span>, the procedure&rsquo;s result is
always void.  The <span class="RktVar">impl-string</span> is either the name of a C
function (or macro) or the body of a C function.</div></p><p>If a single <span class="RktVar">impl-string</span> is provided, and if it is a
string containing only alphanumeric characters and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">_</span><span class="hspace"></span></span>,
then the created Racket procedure passes all of its arguments to
the named C function (or macro) and returns the function&rsquo;s
result. Each argument to the Racket procedure is converted
according to the corresponding <span class="RktVar">argument-type</span> (as
described below) to produce an argument to the C function. Unless
<span class="RktVar">return-type</span> is <span class="RktSym">void</span>, the C function&rsquo;s result is
converted according to <span class="RktVar">return-type</span> for the Racket
procedure&rsquo;s result.</p><p>If more than <span class="RktVar">impl-string</span> is provided, or if it contains more
than alphanumeric characters and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">_</span><span class="hspace"></span></span>, then the concatenated
<span class="RktVar">impl-string</span>s must contain C code to implement the function
body. The converted arguments for the function will be in variables
<span class="stt">___arg1</span>, <span class="stt">___arg2</span>, ... (with three underscores in each
name) in the context where the <span class="RktVar">impl-string</span>s are placed for
compilation. Unless <span class="RktVar">return-type</span> is <span class="RktSym">void</span>, the
<span class="RktVar">impl-string</span>s code should assign a result to the variable
<span class="stt">___result</span> (three underscores), which will be declared but not
initialized. The <span class="RktVar">impl-string</span>s code should not return
explicitly; control should always reach the end of the body. If the
<span class="RktVar">impl-string</span>s code defines the pre-processor macro
<span class="stt">___AT_END</span> (with three leading underscores), then the macro&rsquo;s
value should be C code to execute after the value <span class="stt">___result</span> is
converted to a Racket result, but before the result is returned, all
in the same block; defining <span class="stt">___AT_END</span> is primarily useful for
deallocating a string in <span class="stt">___result</span> that has been copied by
conversion.  The <span class="RktVar">impl-string</span>s code will start on a new line at
the beginning of a block in its compilation context, and
<span class="stt">___AT_END</span> will be undefined after the code.</p><p>In addition to <span class="stt">___arg1</span>, etc., the variable <span class="stt">argc</span> is bound
in <span class="RktVar">impl-string</span>s to the number of arguments supplied to
the function, and <span class="stt">argv</span> is bound to a <span class="stt">Racket_Object*</span> array
of length <span class="stt">argc</span> containing the function arguments as Racket
values. The <span class="stt">argv</span> and <span class="stt">argc</span> variables are mainly useful for
error reporting (e.g., with <span class="stt">racket_wrong_type</span>).</p><p>Each <span class="RktVar">argument-type</span> must be one of the following, which are
recognized symbolically:</p><ul><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">bool</span></p></td></tr><tr><td><p>Racket range: any value</p></td></tr><tr><td><p>C type: <span class="stt">int</span></p></td></tr><tr><td><p>Racket to C conversion: <span class="RktVal">#f</span> &rarr; 0, anything else &rarr; 1</p></td></tr><tr><td><p>C to Racket conversion: 0 &rarr; <span class="RktVal">#f</span>, anything else &rarr; <span class="RktVal">#t</span></p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">char</span></p></td></tr><tr><td><p>Racket range: character</p></td></tr><tr><td><p>C type: <span class="stt">char</span></p></td></tr><tr><td><p>Racket to C conversion: character&rsquo;s Latin-1 value cast to signed byte</p></td></tr><tr><td><p>C to Racket conversion: Latin-1 value from unsigned cast mapped to character</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">unsigned-char</span></p></td></tr><tr><td><p>Racket range: character</p></td></tr><tr><td><p>C type: <span class="stt">unsigned char</span></p></td></tr><tr><td><p>Racket to C conversion: character&rsquo;s Latin-1 value</p></td></tr><tr><td><p>C to Racket conversion: Latin-1 value mapped to character</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">signed-char</span></p></td></tr><tr><td><p>Racket range: character</p></td></tr><tr><td><p>C type: <span class="stt">signed char</span></p></td></tr><tr><td><p>Racket to C conversion: character&rsquo;s Latin-1 value cast to signed byte</p></td></tr><tr><td><p>C to Racket conversion: Latin-1 value from unsigned cast mapped to character</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">int</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into an <span class="stt">int</span></p></td></tr><tr><td><p>C type: <span class="stt">int</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">unsigned-int</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into an <span class="stt">unsigned int</span></p></td></tr><tr><td><p>C type: <span class="stt">unsigned int</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">long</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into a <span class="stt">long</span></p></td></tr><tr><td><p>C type: <span class="stt">long</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">unsigned-long</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into an <span class="stt">unsigned long</span></p></td></tr><tr><td><p>C type: <span class="stt">unsigned long</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">short</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into a <span class="stt">short</span></p></td></tr><tr><td><p>C type: <span class="stt">short</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">unsigned-short</span></p></td></tr><tr><td><p>Racket range: exact integer that fits into an <span class="stt">unsigned short</span></p></td></tr><tr><td><p>C type: <span class="stt">unsigned short</span></p></td></tr><tr><td><p>conversions: (obvious and precise)</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">float</span></p></td></tr><tr><td><p>Racket range: real number</p></td></tr><tr><td><p>C type: <span class="stt">float</span></p></td></tr><tr><td><p>Racket to C conversion: number converted to inexact and cast to <span class="stt">float</span></p></td></tr><tr><td><p>C to Racket conversion: cast to <span class="stt">double</span> and encapsulated as an inexact number</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">double</span></p></td></tr><tr><td><p>Racket range: real number</p></td></tr><tr><td><p>C type: <span class="stt">double</span></p></td></tr><tr><td><p>Racket to C conversion: number converted to inexact</p></td></tr><tr><td><p>C to Racket conversion: encapsulated as an inexact number</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">char-string</span></p></td></tr><tr><td><p>Racket range: byte string or <span class="RktVal">#f</span></p></td></tr><tr><td><p>C type: <span class="stt">char*</span></p></td></tr><tr><td><p>Racket to C conversion: string &rarr; contained byte-array pointer, <span class="RktVal">#f</span> &rarr; <span class="stt">NULL</span></p></td></tr><tr><td><p>C to Racket conversion: <span class="stt">NULL</span> &rarr; <span class="RktVal">#f</span>, anything else &rarr; new byte string created by copying the string</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">nonnull-char-string</span></p></td></tr><tr><td><p>Racket range: byte string</p></td></tr><tr><td><p>C type: <span class="stt">char*</span></p></td></tr><tr><td><p>Racket to C conversion: byte string&rsquo;s contained byte-array pointer</p></td></tr><tr><td><p>C to Racket conversion: new byte string created by copying the string</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktSym">racket-object</span></p></td></tr><tr><td><p>Racket range: any value</p></td></tr><tr><td><p>C type: <span class="stt">Racket_Object*</span></p></td></tr><tr><td><p>Racket to C conversion: no conversion</p></td></tr><tr><td><p>C to Racket conversion: no conversion</p></td></tr></table></li><li><table cellspacing="0" style="display: inline-table; vertical-align: text-top;"><tr><td><p><span class="RktPn">(</span><span class="RktSym">pointer</span><span class="stt"> </span><span class="RktVar">bstr</span><span class="RktPn">)</span></p></td></tr><tr><td><p>Racket range: an opaque c-pointer value, identified as type <span class="RktSym">bstr</span>, or <span class="RktVal">#f</span></p></td></tr><tr><td><p>C type: <span class="RktVar">bstr</span><span class="stt">*</span></p></td></tr><tr><td><p>Racket to C conversion: <span class="RktVal">#f</span> &rarr; <span class="stt">NULL</span>, c-pointer &rarr; contained pointer cast to <span class="RktVar">bstr</span><span class="stt">*</span></p></td></tr><tr><td><p>C to Racket conversion: <span class="stt">NULL</span> &rarr; <span class="RktVal">#f</span>, anything else &rarr; new c-pointer containing the pointer
and identified as type <span class="RktVar">bstr</span></p></td></tr></table></li></ul><p>The <span class="RktVar">return-type</span> must be <span class="RktSym">void</span> or one of the
<span class="RktSym">arg-type</span> keywords.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._compiler/cffi..rkt)._c-declare))"></a><a name="(form._((lib._compiler/cffi..rkt)._c-declare))"></a><span title="Provided from: compiler/cffi"><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">code-string</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Declares arbitrary C code to appear after <span class="stt">"escheme.h"</span> or
<span class="stt">"scheme.h"</span> is included, but before any other code in the
compilation environment of the declaration. A <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> form
can appear only at the top-level or within a module&rsquo;s top-level
sequence.</div></p><p>The <span class="RktSym">code</span> code will appear on a new line in the file for C
compilation. Multiple <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span> declarations are concatenated
(with newlines) in order to produces a sequence of declarations.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._compiler/cffi..rkt)._c-include))"></a><a name="(form._((lib._compiler/cffi..rkt)._c-include))"></a><span title="Provided from: compiler/cffi"><span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-include))" class="RktStxLink" pltdoc="x">c-include</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">path-spec</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Expands to a use of <span class="RktSym"><a href="#(form._((lib._compiler/cffi..rkt)._c-declare))" class="RktStxLink" pltdoc="x">c-declare</a></span> with the content of
<span class="RktVar">path-spec</span>. The <span class="RktVar">path-spec</span> has the same form as for
<a href="../mzlib/mzlib_include.html" class="RktModLink" pltdoc="x"><span class="RktSym">mzlib/include</span></a>&rsquo;s <span class="RktSym"><a href="../mzlib/mzlib_include.html#(form._((lib._mzlib/include..rkt)._include))" class="RktStxLink" pltdoc="x">include</a></span>.</div></p><h3><a name="(part._doc-bibliography)"></a>Bibliography</h3><p><table cellspacing="0" class="RBibliography"><tr><td><a name="(cite._.Feeley98)"></a>[Feeley98]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">Marc Feeley, &ldquo;Gambit-C, version 3.0.&rdquo; 1998.</span></td></tr></table></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>